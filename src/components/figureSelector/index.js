import "./index.css";
import React from "react";
import { useDispatch, useSelector } from "react-redux";

export const shapes = {
  path: {
    path: <path d="M938.666667 308.906667a42.666667 42.666667 0 0 0-12.373334-30.293334l-180.906666-180.906666a42.666667 42.666667 0 0 0-30.293334-12.373334 42.666667 42.666667 0 0 0-30.293333 12.373334l-120.746667 120.746666L97.706667 684.8a42.666667 42.666667 0 0 0-12.373334 30.293333V896a42.666667 42.666667 0 0 0 42.666667 42.666667h180.906667a42.666667 42.666667 0 0 0 32.426666-12.373334l463.786667-466.346666L926.293333 341.333333a50.773333 50.773333 0 0 0 9.386667-14.08 42.666667 42.666667 0 0 0 0-10.24 29.866667 29.866667 0 0 0 0-5.973333zM291.413333 853.333333H170.666667v-120.746666l423.68-423.68 120.746666 120.746666zM775.253333 369.493333l-120.746666-120.746666 60.586666-60.16 120.32 120.32z"></path>
  },
  freeHand: {
    path: <path d="M962.45802178 147.10869599c0-22.5-8.80434756-43.04347823-24.45652178-58.69565244l-1.95652178-1.95652177C903.76236933 54.17391289 851.91454355 54.17391289 819.63193467 85.47826045L342.24063067 528.63043467c-64.56521778-13.69565244-134.02173955 3.91304356-182.93478311 53.80434755C91.80584756 648.95652177 92.78410888 723.30434756 93.76236933 768.30434756v16.63043467c-0.97826045 36.19565244-19.56521777 80.21739112-27.391304 94.89130488-4.89130401 9.78260888-5.86956533 21.52173955-1.95652177 31.30434756 3.91304356 10.76086933 11.73913066 18.58695644 21.52173867 22.5 45.97826045 19.56521777 91.95652177 28.36956533 135.97826132 28.36956533 77.28260888 0 150.65217422-29.34782578 206.41304356-85.10869599 45.97826045-45.97826045 71.41304355-101.73913067 71.41304355-157.5 0-13.69565244-1.95652177-26.41304356-3.91304355-39.13043467l442.17391289-475.43478223C953.65367422 189.17391289 962.45802178 168.63043467 962.45802178 147.10869599zM373.54497822 821.13043467c-57.71739112 57.71739112-136.95652177 76.30434756-220.108696 52.8260871 8.80434756-24.45652178 17.60869599-56.73913067 18.58695733-88.04347821v-19.56521778c-0.97826045-40.10869599-1.95652177-85.10869599 42.0652169-128.15217334 46.95652177-46.95652177 124.23913067-46.95652177 172.17391288 0 23.47826045 23.47826045 36.19565244 51.84782578 36.19565245 81.19565157 0 34.23913067-17.60869599 70.43478222-48.91304355 101.73913066zM883.21889112 150.04347823l-0.97826045 0.97826132-421.63043468 452.93478222c-5.86956533-7.82608711-11.73913066-14.67391289-18.58695644-21.52173955-6.84782578-6.84782578-14.67391289-12.71739112-21.52173955-18.58695644L873.43628223 142.21739112l0.97826132-0.97826045c1.95652177-1.95652177 4.89130401-1.95652177 6.84782578 0l1.95652179 1.95652177c0.97826045 1.95652177 0.97826045 2.93478223 0.97826132 3.91304355 0 0.97826045 0 1.95652177-0.97826132 2.93478223z"></path>
  },
  triangle: {
    path: <path d="M908 915.2H116c-16.08 0-30.79999969-8.80000031-38.08000031-22.00000031a46.75999969 46.75999969 0 0 1 0-43.99999969l396-686.4c7.32-13.2 22.00000031-22.00000031 38.12000062-22.00000031 16.12000031 0 30.79999969 8.80000031 38.11999969 22.00000031l396 686.4c7.36000031 13.2 7.36000031 30.79999969 0 43.99999969-7.32 13.2-22.00000031 22.00000031-38.11999969 22.00000031z m-715.68-88.00000031h639.43999969L512.04000031 272.79999969 192.32 827.19999969z"></path>
  },
  circle: {
    path: <path d="M512 951.99999969C267.99999969 951.99999969 72.00000031 756.00000031 72.00000031 512S267.99999969 72.00000031 512 72.00000031s439.99999969 196.00000031 439.99999969 439.99999969-196.00000031 439.99999969-439.99999969 439.99999969z m0-799.99999969c-199.99999969 0-360 160.00000031-360 360s160.00000031 360 360 360 360-160.00000031 360-360-160.00000031-360-360-360z"></path>
  },
  rect: {
    path: <path d="M164.25714312 881.84h695.48571376c83.98285688 0 126.17142844-41.77714313 126.17142843-124.54285687V266.68571469c0-82.76571469-42.18857156-124.54285687-126.17142843-124.54285781H164.25714312C80.68571469 142.16 38.08571469 183.54285687 38.08571469 266.68571469V757.31428531c0 83.16 42.6 124.54285687 126.17142844 124.54285781z m1.2-64.68c-40.18285687 0-62.67428531-21.29142844-62.67428625-63.08571469V269.94285688c0-41.79428531 22.49142844-63.08571469 62.67428625-63.08571375h693.08571375c39.77142844 0 62.67428531 21.29142844 62.67428625 63.08571375V754.05714312c0 41.79428531-22.90285688 63.08571469-62.67428625 63.08571375z"></path>
  },
  line: {
    path: <path d="M926.293333 97.70666634a42.666667 42.666667 0 0 0-60.586666 0l-768 768a42.666667 42.666667 0 0 0 0 60.586667 42.666667 42.666667 0 0 0 60.586666 0l768-768a42.666667 42.666667 0 0 0 0-60.586667z"></path>
  },
  arc: {
    path: <path d="M868.16112577 267.29291265C868.16112577 230.97127564 868.16112577 194.73801245 868.16112577 158.50474924 477.72562135 158.50474924 161.17062436 475.05974625 161.17062436 865.49525063c57.26623061 0 77.59220753 0 108.78816339 0C269.95878775 535.06556506 537.73144017 267.29291265 868.16112577 267.29291265z"></path>
  }
};

function FigureSelector() {
  const newAction = useDispatch();
  const { drawingStyle, activeSelector } = useSelector((state) => state);
  const { type } = drawingStyle;

  function handleClick({ target }) {
    const { dataset } = target;
    if (dataset.type === type || !dataset.type) return;
    newAction({
      type: "SET_DRAWING_STYLE",
      style: { ...drawingStyle, type: dataset.type },
    });
  }

  function toggleSelector() {
    newAction({
      type: "SET_ACTIVE_SELECTOR",
      activeSelector: activeSelector === 'figure-selector' ? '' : 'figure-selector'
    });
  }

  return (
    <div className={activeSelector === 'figure-selector' ? "tool-bar-group active-group" : "tool-bar-group"}
      onClick={toggleSelector}>
      <svg
        viewBox="0 0 1024 1024"
        xmlns="http://www.w3.org/2000/svg"
        className="tool-bar-item"
      >{shapes[type].path}</svg>
      <div
        className="tool-bar-popover figure-selector"
        onClick={handleClick}
      >
        {Object.entries(shapes).map(([key, value]) =>
          <svg
            key={key}
            viewBox="0 0 1024 1024"
            xmlns="http://www.w3.org/2000/svg"
            data-type={key}
            className="tool-bar-item"
          >{value.path}</svg>
        )}
      </div>
    </div>
  );
}

export default FigureSelector;
