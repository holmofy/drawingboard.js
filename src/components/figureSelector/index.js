import "./index.css";
import React from "react";
import { useDispatch, useSelector } from "react-redux";

const shapes = {
  path: {
    path: <path d="M997.45185223 280.9249189a48.54518557 48.54518557 0 0 0-14.07810446-34.46708224l-205.83158443-205.83158443a48.54518557 48.54518557 0 0 0-34.46708224-14.07810446 48.54518557 48.54518557 0 0 0-34.4670811 14.07810446l-137.38287445 137.38287332L40.62625223 708.608a48.54518557 48.54518557 0 0 0-14.07810446 34.4670811V948.90666667a48.54518557 48.54518557 0 0 0 48.54518556 48.54518556h205.83158557a48.54518557 48.54518557 0 0 0 36.89433998-14.07810446l527.68616334-530.59887332L983.37374777 317.81925888a57.76876999 57.76876999 0 0 0 10.67994112-16.01991111 48.54518557 48.54518557 0 0 0 0-11.65084444 33.98163001 33.98163001 0 0 0 0-6.79632555zM261.02139221 900.3614811H123.6385189v-137.38287331l482.05368889-482.05368889 137.38287331 137.38287331zM811.52379221 349.8590811l-137.38287331-137.38287331 68.9341622-68.44871112 136.89742223 136.89742223z"></path>
  },
  triangle: {
    path: <path d="M934.4 942.08H89.6c-17.152 0-32.853333-9.386667-40.618667-23.466667a49.877333 49.877333 0 0 1 0-46.933333l422.4-732.16c7.808-14.08 23.466667-23.466667 40.661334-23.466667 17.194667 0 32.853333 9.386667 40.661333 23.466667l422.4 732.16c7.850667 14.08 7.850667 32.853333 0 46.933333-7.808 14.08-23.466667 23.466667-40.661333 23.466667z m-763.392-93.866667h682.069333L512.042667 256.853333 171.008 848.213333z"></path>
  },
  circle: {
    path: <path d="M512 981.333333C251.733333 981.333333 42.666667 772.266667 42.666667 512S251.733333 42.666667 512 42.666667s469.333333 209.066667 469.333333 469.333333-209.066667 469.333333-469.333333 469.333333z m0-853.333333c-213.333333 0-384 170.666667-384 384s170.666667 384 384 384 384-170.666667 384-384-170.666667-384-384-384z"></path>
  },
  rect: {
    path: <path d="M841.34 959.36H182.66c-65.06 0-117.99-52.94-117.99-118.02V182.69c0-65.08 52.94-118.04 117.99-118.04h658.68c65.06 0 117.99 52.96 117.99 118.04v658.65c0 65.08-52.93 118.02-117.99 118.02zM182.66 142.17c-22.31 0-40.51 18.18-40.51 40.51v658.65c0 22.34 18.2 40.49 40.51 40.49h658.68c22.31 0 40.51-18.15 40.51-40.49V182.69c0-22.34-18.2-40.51-40.51-40.51H182.66z" />
  },
  line: {
    path: <path d="M926.293333 97.70666634a42.666667 42.666667 0 0 0-60.586666 0l-768 768a42.666667 42.666667 0 0 0 0 60.586667 42.666667 42.666667 0 0 0 60.586666 0l768-768a42.666667 42.666667 0 0 0 0-60.586667z"></path>
  },
  arc: {
    path: <path d="M868.16112577 267.29291265C868.16112577 230.97127564 868.16112577 194.73801245 868.16112577 158.50474924 477.72562135 158.50474924 161.17062436 475.05974625 161.17062436 865.49525063c57.26623061 0 77.59220753 0 108.78816339 0C269.95878775 535.06556506 537.73144017 267.29291265 868.16112577 267.29291265z"></path>
  }
};

function FigureSelector() {
  const newAction = useDispatch();
  const { drawingStyle, activeSelector } = useSelector((state) => state);
  const { type } = drawingStyle;

  function handleClick({ target }) {
    const { dataset } = target;
    if (dataset.type === type || !dataset.type) return;
    newAction({
      type: "SET_DRAWING_STYLE",
      style: { ...drawingStyle, type: dataset.type },
    });
  }

  function toggleSelector() {
    newAction({
      type: "SET_ACTIVE_SELECTOR",
      activeSelector: activeSelector === 'figure-selector' ? '' : 'figure-selector'
    });
  }

  return (
    <div className={activeSelector === 'figure-selector' ? "tool-bar-group active-group" : "tool-bar-group"}
      onClick={toggleSelector}>
      <svg
        viewBox="0 0 1280 1024"
        xmlns="http://www.w3.org/2000/svg"
        className="tool-bar-item"
      >{shapes[type].path}</svg>
      <div
        className="tool-bar-popover figure-selector"
        onClick={handleClick}
      >
        {Object.entries(shapes).map(([key, value]) =>
          <svg
            key={key}
            viewBox="0 0 1280 1024"
            xmlns="http://www.w3.org/2000/svg"
            data-type={key}
            className="tool-bar-item"
          >{value.path}</svg>
        )}
      </div>
    </div>
  );
}

export default FigureSelector;
