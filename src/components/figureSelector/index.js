import "./index.css";
import React from "react";
import { useDispatch, useSelector } from "react-redux";

const shapes = {
  path: {
    path: <path d="M997.45185223 280.9249189a48.54518557 48.54518557 0 0 0-14.07810446-34.46708224l-205.83158443-205.83158443a48.54518557 48.54518557 0 0 0-34.46708224-14.07810446 48.54518557 48.54518557 0 0 0-34.4670811 14.07810446l-137.38287445 137.38287332L40.62625223 708.608a48.54518557 48.54518557 0 0 0-14.07810446 34.4670811V948.90666667a48.54518557 48.54518557 0 0 0 48.54518556 48.54518556h205.83158557a48.54518557 48.54518557 0 0 0 36.89433998-14.07810446l527.68616334-530.59887332L983.37374777 317.81925888a57.76876999 57.76876999 0 0 0 10.67994112-16.01991111 48.54518557 48.54518557 0 0 0 0-11.65084444 33.98163001 33.98163001 0 0 0 0-6.79632555zM261.02139221 900.3614811H123.6385189v-137.38287331l482.05368889-482.05368889 137.38287331 137.38287331zM811.52379221 349.8590811l-137.38287331-137.38287331 68.9341622-68.44871112 136.89742223 136.89742223z"></path>
  },
  freeHand: {
    path: <path d="M1024.521127 96.834783c0-25.6-10.017391-48.973913-27.826087-66.782609l-2.226087-2.226087C957.738518-8.904348 898.747214-8.904348 862.016779 26.713043L318.851562 530.921739c-73.46087-15.582609-152.486957 4.452174-208.139131 61.217391C33.912431 667.826087 35.025475 752.417391 36.138518 803.617391v18.921739c-1.113043 41.182609-22.26087 91.269565-31.165217 107.965218-5.565217 11.130435-6.678261 24.486957-2.226087 35.617391 4.452174 12.243478 13.356522 21.147826 24.486956 25.6 52.313043 22.26087 104.626087 32.278261 154.713044 32.278261 87.930435 0 171.408696-33.391304 234.852174-96.834783 52.313043-52.313043 81.252174-115.756522 81.252174-179.2 0-15.582609-2.226087-30.052174-4.452174-44.521739l503.095652-540.93913C1014.503736 144.695652 1024.521127 121.321739 1024.521127 96.834783zM354.468953 863.721739c-65.669565 65.669565-155.826087 86.817391-250.434783 60.104348 10.017391-27.826087 20.034783-64.556522 21.147827-100.173913v-22.26087c-1.113043-45.634783-2.226087-96.834783 47.860869-145.808695 53.426087-53.426087 141.356522-53.426087 195.895652 0 26.713043 26.713043 41.182609 58.991304 41.182609 92.382608 0 38.956522-20.034783 80.13913-55.652174 115.756522zM934.364605 100.173913l-1.113043 1.113044-479.721739 515.33913c-6.678261-8.904348-13.356522-16.695652-21.147826-24.486957-7.791304-7.791304-16.695652-14.469565-24.486957-21.147826L923.23417 91.269565l1.113044-1.113043c2.226087-2.226087 5.565217-2.226087 7.791304 0l2.226087 2.226087c1.113043 2.226087 1.113043 3.33913 1.113044 4.452174 0 1.113043 0 2.226087-1.113044 3.33913z"></path>
  },
  triangle: {
    path: <path d="M934.4 942.08H89.6c-17.152 0-32.853333-9.386667-40.618667-23.466667a49.877333 49.877333 0 0 1 0-46.933333l422.4-732.16c7.808-14.08 23.466667-23.466667 40.661334-23.466667 17.194667 0 32.853333 9.386667 40.661333 23.466667l422.4 732.16c7.850667 14.08 7.850667 32.853333 0 46.933333-7.808 14.08-23.466667 23.466667-40.661333 23.466667z m-763.392-93.866667h682.069333L512.042667 256.853333 171.008 848.213333z"></path>
  },
  circle: {
    path: <path d="M512 981.333333C251.733333 981.333333 42.666667 772.266667 42.666667 512S251.733333 42.666667 512 42.666667s469.333333 209.066667 469.333333 469.333333-209.066667 469.333333-469.333333 469.333333z m0-853.333333c-213.333333 0-384 170.666667-384 384s170.666667 384 384 384 384-170.666667 384-384-170.666667-384-384-384z"></path>
  },
  rect: {
    path: <path d="M841.34 959.36H182.66c-65.06 0-117.99-52.94-117.99-118.02V182.69c0-65.08 52.94-118.04 117.99-118.04h658.68c65.06 0 117.99 52.96 117.99 118.04v658.65c0 65.08-52.93 118.02-117.99 118.02zM182.66 142.17c-22.31 0-40.51 18.18-40.51 40.51v658.65c0 22.34 18.2 40.49 40.51 40.49h658.68c22.31 0 40.51-18.15 40.51-40.49V182.69c0-22.34-18.2-40.51-40.51-40.51H182.66z" />
  },
  line: {
    path: <path d="M926.293333 97.70666634a42.666667 42.666667 0 0 0-60.586666 0l-768 768a42.666667 42.666667 0 0 0 0 60.586667 42.666667 42.666667 0 0 0 60.586666 0l768-768a42.666667 42.666667 0 0 0 0-60.586667z"></path>
  },
  arc: {
    path: <path d="M868.16112577 267.29291265C868.16112577 230.97127564 868.16112577 194.73801245 868.16112577 158.50474924 477.72562135 158.50474924 161.17062436 475.05974625 161.17062436 865.49525063c57.26623061 0 77.59220753 0 108.78816339 0C269.95878775 535.06556506 537.73144017 267.29291265 868.16112577 267.29291265z"></path>
  }
};

function FigureSelector() {
  const newAction = useDispatch();
  const { drawingStyle, activeSelector } = useSelector((state) => state);
  const { type } = drawingStyle;

  function handleClick({ target }) {
    const { dataset } = target;
    if (dataset.type === type || !dataset.type) return;
    newAction({
      type: "SET_DRAWING_STYLE",
      style: { ...drawingStyle, type: dataset.type },
    });
  }

  function toggleSelector() {
    newAction({
      type: "SET_ACTIVE_SELECTOR",
      activeSelector: activeSelector === 'figure-selector' ? '' : 'figure-selector'
    });
  }

  return (
    <div className={activeSelector === 'figure-selector' ? "tool-bar-group active-group" : "tool-bar-group"}
      onClick={toggleSelector}>
      <svg
        viewBox="0 0 1280 1024"
        xmlns="http://www.w3.org/2000/svg"
        className="tool-bar-item"
      >{shapes[type].path}</svg>
      <div
        className="tool-bar-popover figure-selector"
        onClick={handleClick}
      >
        {Object.entries(shapes).map(([key, value]) =>
          <svg
            key={key}
            viewBox="0 0 1280 1024"
            xmlns="http://www.w3.org/2000/svg"
            data-type={key}
            className="tool-bar-item"
          >{value.path}</svg>
        )}
      </div>
    </div>
  );
}

export default FigureSelector;
